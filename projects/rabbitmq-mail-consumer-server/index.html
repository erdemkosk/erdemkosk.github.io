<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>rabbitmq-mail-consumer-server | Erdem Köşk</title>
    <meta name="description" content="Headless mail consumer which is for sending mails and abstract it. If you want it controls blacklist from redis.">
    <meta name="generator" content="VuePress 1.3.0">
    
    <meta property="og:site_name" content="Erdem Köşk"><meta property="og:title" content="rabbitmq-mail-consumer-server"><meta property="og:description" content="Headless mail consumer which is for sending mails and abstract it. If you want it controls blacklist from redis."><meta property="og:type" content="website"><meta property="og:url" content="/_projects/rabbitmq-mail-consumer-server.html"><meta name="twitter:title" content="rabbitmq-mail-consumer-server"><meta name="twitter:description" content="Headless mail consumer which is for sending mails and abstract it. If you want it controls blacklist from redis."><meta name="twitter:url" content="/_projects/rabbitmq-mail-consumer-server.html"><meta name="twitter:card" content="summary_large_image">
    <link rel="preload" href="/assets/css/0.styles.17a71377.css" as="style"><link rel="preload" href="/assets/js/app.b43934e8.js" as="script"><link rel="preload" href="/assets/js/6.fd423659.js" as="script"><link rel="preload" href="/assets/js/26.819dd34c.js" as="script"><link rel="preload" href="/assets/js/5.b2e166d7.js" as="script"><link rel="prefetch" href="/assets/js/10.4e0c727b.js"><link rel="prefetch" href="/assets/js/11.5013edd4.js"><link rel="prefetch" href="/assets/js/12.fb1f620c.js"><link rel="prefetch" href="/assets/js/13.fe6f17e1.js"><link rel="prefetch" href="/assets/js/14.a2b69532.js"><link rel="prefetch" href="/assets/js/15.11d2fa52.js"><link rel="prefetch" href="/assets/js/16.af51f632.js"><link rel="prefetch" href="/assets/js/17.58f23ada.js"><link rel="prefetch" href="/assets/js/18.d1b9ba12.js"><link rel="prefetch" href="/assets/js/19.70a37d52.js"><link rel="prefetch" href="/assets/js/20.528530e9.js"><link rel="prefetch" href="/assets/js/21.02b52d4e.js"><link rel="prefetch" href="/assets/js/22.0c70b55e.js"><link rel="prefetch" href="/assets/js/23.60c98be0.js"><link rel="prefetch" href="/assets/js/24.9317fc5e.js"><link rel="prefetch" href="/assets/js/25.4d433705.js"><link rel="prefetch" href="/assets/js/27.997feb42.js"><link rel="prefetch" href="/assets/js/28.8a72b18d.js"><link rel="prefetch" href="/assets/js/3.ab744aaa.js"><link rel="prefetch" href="/assets/js/4.d65e5dbc.js"><link rel="prefetch" href="/assets/js/7.0ff9607a.js"><link rel="prefetch" href="/assets/js/8.0d2f234b.js"><link rel="prefetch" href="/assets/js/9.07635358.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.293e62a1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.17a71377.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><header id="header" class="shadow"><div class="p-3 d-flex justify-content-between"><a href="/" class="text-decoration-none h4 router-link-active">
      Erdem Köşk
    </a> <div class="search-wrapper u-px3"><div aria-haspopup="listbox" role="combobox" aria-owns="el-autocomplete-5689" class="el-autocomplete"><div class="el-input el-input--small"><!----><input type="text" autocomplete="off" valueKey="value" popperClass="components-search" placeholder="Search" fetchSuggestions="function () { [native code] }" debounce="200" placement="bottom-end" popperAppendToBody="true" class="el-input__inner"><!----><!----><!----><!----></div><div role="region" class="el-autocomplete-suggestion el-popper components-search" style="width:;display:none;"><div class="el-scrollbar"><div class="el-autocomplete-suggestion__wrap el-scrollbar__wrap el-scrollbar__wrap--hidden-default"><ul class="el-scrollbar__view el-autocomplete-suggestion__list"></ul></div><div class="el-scrollbar__bar is-horizontal"><div class="el-scrollbar__thumb" style="width:0;transform:translateX(0%);ms-transform:translateX(0%);webkit-transform:translateX(0%);"></div></div><div class="el-scrollbar__bar is-vertical"><div class="el-scrollbar__thumb" style="height:0;transform:translateY(0%);ms-transform:translateY(0%);webkit-transform:translateY(0%);"></div></div></div></div></div></div></div> <nav class="px-5"><ul role="menubar" class="d-flex justify-content-center border-0 el-menu--horizontal el-menu" style="background-color:;"><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;border-bottom-color:transparent;background-color:;"><a href="/" class="text-decoration-none d-block h-100 w-100 router-link-active"><i class="el-icon-house"></i>
          Home
        </a></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;border-bottom-color:transparent;background-color:;"><a href="/projects/" class="text-decoration-none d-block h-100 w-100 router-link-active"><i class="el-icon-folder"></i>
          Projects
        </a></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;border-bottom-color:transparent;background-color:;"><a href="/pages/about/" class="text-decoration-none d-block h-100 w-100"><i class="el-icon-user"></i>
          About
        </a></li></ul></nav></header> <div id="vuperess-theme-blog__post-layout" data-v-a00919d2><main class="vuepress-blog-theme-content" data-v-a00919d2><div class="el-card my-4 is-always-shadow" data-v-a00919d2><!----><div class="el-card__body" style="padding:1rem 2rem;"><div data-v-a00919d2><h1 class="text-center text-capitalize" data-v-a00919d2>rabbitmq-mail-consumer-server</h1> <hr data-v-a00919d2> <p class="text-secondary" data-v-a00919d2>Headless mail consumer which is for sending mails and abstract it. If you want it controls blacklist from redis.</p> <ul class="languages-list" data-v-a00919d2><li data-v-a00919d2>Redis</li><li data-v-a00919d2>Node.Js</li><li data-v-a00919d2>Rabbit MQ</li></ul></div></div></div> <div class="el-card is-always-shadow" data-v-a00919d2><!----><div class="el-card__body" style="padding:1rem 2rem;"><div class="content__default" data-v-a00919d2><h1 id="rabbitmq-mail-consumer-server"><a href="#rabbitmq-mail-consumer-server" class="header-anchor">#</a> rabbitmq-mail-consumer-server</h1> <p>Rabbitmq-mail-consumer-server is an independent mail sending server that abstracts the sending mails from system. Services that want to send mail do not need to know where and how this server works 😎. Just make sure you're looking at the same rabbit mq channel.</p> <blockquote><p>Sending mail is abstracted from the whole system. You don't have to think ✌️.</p></blockquote> <h3 id="tech"><a href="#tech" class="header-anchor">#</a> Tech</h3> <p><img src="https://i.imgur.com/hlDKK7Z.png" alt="Tech">
Rabbitmq-mail-consumer-server uses a number of open source projects to work properly:</p> <ul><li>[Node Js] - for runnig server</li> <li>[Rabbit MQ] - for getting messages from another server</li> <li>[Redis] - for checking email blacklist</li></ul> <h3 id="for-blacklist"><a href="#for-blacklist" class="header-anchor">#</a> For Blacklist</h3> <p>You need to add a mail adress to redis.</p> <blockquote><p>/unsubscribe?email=(with encrypted mail)
<img src="https://i.imgur.com/saREwA7.png" alt="Redis"></p></blockquote> <h3 id="installation"><a href="#installation" class="header-anchor">#</a> Installation</h3> <p>Rabbitmq-mail-consumer-server requires <a href="https://nodejs.org/" target="_blank" rel="noopener noreferrer">Node.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> v8+ to run.</p> <p>Install the dependencies and devDependencies and start the server.</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ <span class="token builtin class-name">cd</span> rabbitmq-mail-consumer-server
$ <span class="token function">npm</span> <span class="token function">install</span> 
$ node app
</code></pre></div><p>For Make A Docker Image:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ docker build -t  rabbitmq-mail-consumer-server <span class="token builtin class-name">.</span>
$ docker run --env-file .env -p <span class="token number">5000</span>:5000 rabbitmq-mail-consumer-server
</code></pre></div><p>Pull From Docker Hub</p> <ul><li>latest</li> <li>rpi =&gt; ARM build for raspperry pi</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>$ docker run --env-file .env -p <span class="token number">5000</span>:5000 erdemkosk/rabbitmq-mail-consumer-server:latest
or
$ docker run --env-file .env -p <span class="token number">5000</span>:5000 erdemkosk/rabbitmq-mail-consumer-server:rpi
</code></pre></div><h3 id="running-stages"><a href="#running-stages" class="header-anchor">#</a> Running Stages</h3> <p>You need to send messages from your server to rabbit mq channel when you need to send mail.
Forget Password Mail:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>  rabbitMq.sendRabbitMQ<span class="token punctuation">(</span><span class="token string">'mailChannel'</span>, JSON.stringify<span class="token punctuation">(</span><span class="token punctuation">{</span>
    email: <span class="token string">'testme-app@yandex.ru'</span>,
    nameSurname: <span class="token string">'Erdem Köşk'</span>,
    type: <span class="token string">'forget'</span>,
    appName: <span class="token string">'Test Me'</span>,
    forgetTitle: <span class="token string">'Şifreni Unutmuşsun :('</span>,
    forgetMessage: <span class="token string">'&lt;b&gt;nameSurname&lt;/b&gt; şifreni unutmuşsun! Aşağıdaki adımları takip edelim.'</span>,
    mailIcon: <span class="token string">'https://img.icons8.com/clouds/100/000000/jake.png'</span>,
    webSiteLink: <span class="token string">'http://localhost:3000'</span>,
    webSiteLinkButton: <span class="token string">'Hadi Başlayalım!'</span>,
    warningText: <span class="token string">'Şifre sıfırlama talebini siz yollamadıysanız, lütfen dikkate almayın !'</span>,
    sincerelyText: <span class="token string">'Sevgilerle'</span>,
    needHelpText: <span class="token string">'Yardım mı lazım?'</span>,
    needHelpLink: <span class="token string">'http://erdemkosk.com'</span>,
  <span class="token punctuation">}</span><span class="token punctuation">))</span><span class="token punctuation">;</span>
</code></pre></div><p>Register Mail:</p> <div class="language-sh extra-class"><pre class="language-sh"><code> rabbitMq.sendRabbitMQ<span class="token punctuation">(</span><span class="token string">'mailChannel'</span>, JSON.stringify<span class="token punctuation">(</span><span class="token punctuation">{</span>
    email: <span class="token string">'testme-app@yandex.ru'</span>,
    nameSurname: <span class="token string">'Erdem Köşk'</span>,
    type: <span class="token string">'register'</span>,
    appName: <span class="token string">'Test Me'</span>,
    welcomeTitle: <span class="token string">'Hoş Geldin!'</span>,
    welcomeMessage: <span class="token string">'Seni aramızda görmek çok güzel &lt;b&gt; nameSurname &lt;/b&gt; ! &lt;br/&gt; İngilizce kelime öğrenmenin en kolay yolu 🤙. Boş zamanlarında senin için oluşturulan rastgele ingilizce kelime testlerini cevapla 🙏 Kendini geliştir!'</span>,
    mailIcon: <span class="token string">'https://img.icons8.com/clouds/100/000000/america.png'</span>,
    webSiteLink: <span class="token string">'http://localhost:3000'</span>,
    webSiteLinkButton: <span class="token string">'Hadi Başlayalım!'</span>,
    thanksText: <span class="token string">'Projemize destek verdiğin için teşekkür ederiz!'</span>,
    sincerelyText: <span class="token string">'Sevgilerle'</span>,
    needHelpText: <span class="token string">'Yardım mı lazım?'</span>,
    needHelpLink: <span class="token string">'http://erdemkosk.com'</span>,
  <span class="token punctuation">}</span><span class="token punctuation">))</span><span class="token punctuation">;</span>
</code></pre></div><p>When messages arrvied rabbitmq-mail-consumer-server, it controls mail in blacklist (from redis).</p> <p>If In Not Blacklist:
<img src="https://i.imgur.com/2cWUecy.png" alt="In Not Blacklist"></p> <p>If In Blacklist:
<img src="https://i.imgur.com/bFe9r4e.png" alt="In Blacklist"></p> <h3 id="env-variables"><a href="#env-variables" class="header-anchor">#</a> Env Variables</h3> <table><thead><tr><th>Env</th> <th style="text-align:center;">Example</th></tr></thead> <tbody><tr><td>NODE_ENV</td> <td style="text-align:center;">dev</td></tr> <tr><td>RABBITMQ_URL</td> <td style="text-align:center;">amqp url</td></tr> <tr><td>RABBITMQ_CHANNEL</td> <td style="text-align:center;">amqp channel</td></tr> <tr><td>MAIL_USER</td> <td style="text-align:center;">user mail</td></tr> <tr><td>MAIL_PASS</td> <td style="text-align:center;">yser mail password</td></tr> <tr><td>MAIL_HOST</td> <td style="text-align:center;">smtp mail server</td></tr> <tr><td>MAIL_PORT</td> <td style="text-align:center;">smtp mail port</td></tr> <tr><td>REDIS_HOST</td> <td style="text-align:center;">redis url</td></tr> <tr><td>REDIS_PASS</td> <td style="text-align:center;">redis password</td></tr> <tr><td>REDIS_PORT</td> <td style="text-align:center;">redis port</td></tr> <tr><td>URL</td> <td style="text-align:center;">unsubscribe url path</td></tr></tbody></table> <h3 id="mail-types"><a href="#mail-types" class="header-anchor">#</a> Mail Types</h3> <p>There are two types of mail. Its type can be easily increased and different parameters can be sent for each.🙏</p> <ul><li>Register</li> <li>Forget</li></ul> <p>Register:
<img src="https://i.imgur.com/72AEhxE.png" alt="Register">
Forget:
<img src="https://i.imgur.com/9up6jB3.png" alt="Forget"></p></div></div></div></main></div> <footer class="footer" data-v-443d97ee><div class="footer-left-wrap" data-v-443d97ee><ul class="contact" data-v-443d97ee><li class="contact-item" data-v-443d97ee><a href="https://github.com/erdemkosk" target="_blank" rel="noopener noreferrer" class="external" data-v-443d97ee><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github" data-v-443d97ee><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" data-v-443d97ee></path></svg>
          
        </a></li><li class="contact-item" data-v-443d97ee><a href="http://www.instagram.com/erdemkosk" target="_blank" rel="noopener noreferrer" class="external" data-v-443d97ee><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-instagram" data-v-443d97ee><rect x="2" y="2" width="20" height="20" rx="5" ry="5" data-v-443d97ee></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z" data-v-443d97ee></path><line x1="17.5" y1="6.5" x2="17.5" y2="6.5" data-v-443d97ee></line></svg>
          
        </a></li><li class="contact-item" data-v-443d97ee><a href="https://www.linkedin.com/in/erdemkosk/" target="_blank" rel="noopener noreferrer" class="external" data-v-443d97ee><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-linkedin" data-v-443d97ee><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z" data-v-443d97ee></path><rect x="2" y="9" width="4" height="12" data-v-443d97ee></rect><circle cx="4" cy="4" r="2" data-v-443d97ee></circle></svg>
          
        </a></li><li class="contact-item" data-v-443d97ee><a href="http://www.twitter.com/erdemkosk" target="_blank" rel="noopener noreferrer" class="external" data-v-443d97ee><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter" data-v-443d97ee><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z" data-v-443d97ee></path></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-443d97ee><ul class="copyright" data-v-443d97ee><li class="copyright-item" data-v-443d97ee><a href="https://policies.google.com/privacy?hl=en-US" target="_blank" rel="noopener noreferrer" class="external" data-v-443d97ee>Privacy Policy</a></li><li class="copyright-item" data-v-443d97ee><a href="/projects/rabbitmq-mail-consumer-server/.html" data-v-443d97ee>Copyright © 2020 Mustafa Erdem Köşk</a></li></ul></div></footer></div><div class="global-ui"><div class="reading-progress top" data-v-56679cca><div class="progress" data-v-56679cca></div></div><!----></div></div>
    <script src="/assets/js/app.b43934e8.js" defer></script><script src="/assets/js/6.fd423659.js" defer></script><script src="/assets/js/26.819dd34c.js" defer></script><script src="/assets/js/5.b2e166d7.js" defer></script>
  </body>
</html>
